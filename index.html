<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <link rel="icon" href="favicon.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="manifest" href="manifest.json" />
  <title>Yape App</title>

  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
  <link rel="stylesheet" href="styles.css?v=4">

  <!-- ESTILOS INTERNOS (sin modificar comportamiento) -->
  <style>
    html {
      overflow: hidden;
      height: 100%;
    }
    body{
      -webkit-user-select: none; /* Safari */
      -moz-user-select: none; /* Firefox */
      -ms-user-select: none; /* IE 10+ */
      user-select: none; /* estÃ¡ndar */
      margin: 0;
      overflow: auto;
      height: 100%;	
      touch-action: manipulation; /* Desactiva el doble-tap para zoom */
      overscroll-behavior-y: none; /* Elimina el efecto de rebote */
      position: fixed;
    }
    button,
    div,
    input,
    textarea,
    select,
    a {
      -webkit-tap-highlight-color: transparent;
    }
  </style>
</head>

<body class="pantalla-ingresar-monto-activa">

  <!-- Splash Screen -->
  <div id="splash-screen" style="
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #742384; /* JsKSJ8288K-I2UJWJJJSUUUWJSJSHSHSJEJEIUEJEJEJJEDJUDUDU */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
  ">
    <img src="assets/+HEDJKKK-88WKK-81.svg" alt="Logo" style="
      width: 25vw;
      max-width: 100px;
      height: auto;
    ">
  </div>

  <div id="app-container"></div>

  <div class="modal-confirmacion" id="modalEliminar">
    <div class="contenido">
      <h3>Â¿Eliminar movimiento?</h3>
      <p>Esta acciÃ³n no se puede deshacer.</p>
      <div class="botones">
        <button class="btn-si" id="btnEliminarSi">Eliminar</button>
        <button class="btn-no" id="btnEliminarNo">Cancelar</button>
      </div>
    </div>
  </div>

  <script src="app.js?v=5"></script>
<!-- BotÃ³n oculto -->
<button
  id="resetAppBtn"
  style="
    display:none;
    position:fixed;
    bottom:20px;
    right:20px;
    z-index:9999;
    padding:12px 16px;
    background:#e53935;
    color:#fff;
    border:none;
    border-radius:8px;
    font-size:14px;
  "
>
  ðŸ§¹ Reset App
</button>

<script>
  let tapCount = 0;
  let tapTimer = null;

  document.addEventListener("touchstart", () => {
    tapCount++;

    if (tapCount === 1) {
      tapTimer = setTimeout(() => {
        tapCount = 0;
      }, 800); // tiempo mÃ¡ximo entre taps
    }

    if (tapCount === 4) {
      clearTimeout(tapTimer);
      tapCount = 0;
      document.getElementById("resetAppBtn").style.display = "block";
    }
  });

  document.getElementById("resetAppBtn").addEventListener("click", async () => {
    // Local & session storage
    localStorage.clear();
    sessionStorage.clear();

    // IndexedDB
    if (window.indexedDB) {
      indexedDB.databases().then(dbs => {
        dbs.forEach(db => indexedDB.deleteDatabase(db.name));
      });
    }

    // Cache API (PWA)
    if (window.caches) {
      const keys = await caches.keys();
      await Promise.all(keys.map(k => caches.delete(k)));
    }

    alert("Datos borrados. Reiniciando app...");
    location.reload();
  });
</script>
</body>
</html>
